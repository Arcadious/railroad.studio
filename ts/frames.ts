import {GvasString} from './Gvas';
import {NumericFrameState} from './Railroad';

export const frameTypes = [
    '622D',
    'boxcar',
    'caboose',
    'class70',
    'class70_tender',
    'climax',
    'cooke260',
    'cooke260_tender',
    'cooke280',
    'cooke280_tender',
    'eureka',
    'eureka_tender',
    'flatcar_cordwood',
    'flatcar_hopper',
    'flatcar_logs',
    'flatcar_stakes',
    'flatcar_tanker',
    'glenbrook',
    'glenbrook_tender',
    'handcar',
    'heisler',
    'montezuma',
    'montezuma_tender',
    'mosca',
    'mosca_tender',
    'plow',
    'porter_040',
    'porter_042',
    'shay',
    'waycar',
] as const;

type FrameType = typeof frameTypes[number];

export const isFrameType = (type: GvasString): type is FrameType =>
    type ? frameTypes.includes(type) : false;

export const frameCategories = ['engine', 'tender', 'handcar', 'freight', 'passenger', 'mow'] as const;

type FrameCategories = typeof frameCategories[number];

type PRO<K extends string | number | symbol, T> = Partial<Readonly<Record<K, T>>>;

export interface FrameDefinition extends PRO<FrameCategories, boolean> {
    length: number;
    name: string;
    name_length: number;
    name_lines: number;
    number_length: number;
    number_lines: number;
    min?: PRO<keyof NumericFrameState, number>;
    max?: PRO<keyof NumericFrameState, number>;
}

export const frameDefinitions: Record<FrameType, FrameDefinition> = {
    '622D': {
        engine: true,
        length: 760.0,
        name: 'D&RGW Class 48',
        name_length: 20,
        name_lines: 3,
        number_length: 4,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 2,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 3,
            tenderFuelAmount: 144,
            tenderWaterAmount: 1600,
        },
    },
    'boxcar': {
        freight: true,
        length: 822.82,
        name: 'Boxcar',
        name_length: 13,
        name_lines: 4,
        number_length: 7,
        number_lines: 4,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 7,
            smokestackType: 1,
        },
    },
    'caboose': {
        length: 679.0,
        name: 'Bobber Caboose',
        name_length: 20,
        name_lines: 1,
        number_length: 12,
        number_lines: 1,
        passenger: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 50,
            boilerPressure: 120,
            boilerWaterLevel: 500,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 1,
            markerLightsCenterState: 3,
            markerLightsFrontLeftState: 3,
            markerLightsFrontRightState: 3,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 10,
            smokestackType: 1,
            tenderFuelAmount: 15,
        },
    },
    'class70': {
        engine: true,
        name: 'D&RG Class 70',
        length: 938.9,
        name_length: 14,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 100,
            boilerPressure: 130,
            boilerWaterLevel: 6000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            markerLightsFrontLeftState: 3,
            markerLightsFrontRightState: 3,
            paintType: 3,
            regulatorValue: 1,
            reverserValue: 1,
            headlightType: 3,
            sanderAmount: 100,
            smokestackType: 3,
        },
    },
    'class70_tender': {
        length: 678.81,
        name: 'Class 70 Tender',
        name_length: 22,
        name_lines: 3,
        number_length: 0,
        number_lines: 0,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 3,
            smokestackType: 1,
            tenderFuelAmount: 1350,
            tenderWaterAmount: 9500,
        },
    },
    'climax': {
        engine: true,
        length: 849.89,
        name: 'Climax',
        name_length: 11,
        name_lines: 7,
        number_length: 2,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 80,
            boilerPressure: 160,
            boilerWaterLevel: 4000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            generatorValveValue: 1,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            headlightType: 1,
            sanderAmount: 100,
            smokestackType: 3,
            tenderFuelAmount: 332,
            tenderWaterAmount: 3000,
        },
    },
    'cooke260': {
        engine: true,
        length: 837.83,
        name: 'Cooke Mogul',
        name_length: 12,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 80,
            boilerPressure: 150,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            headlightType: 2,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 3,
        },
    },
    'cooke260_tender': {
        length: 641.73,
        name: 'Cooke Mogul Tender',
        name_length: 11,
        name_lines: 1,
        number_length: 6,
        number_lines: 1,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 1,
            tenderFuelAmount: 1460,
            tenderWaterAmount: 9500,
            smokestackType: 1,
        },
    },
    'cooke280': {
        engine: true,
        name: 'Cooke Consolidation',
        length: 870.0,
        name_length: 12,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            headlightType: 3,
            markerLightsFrontLeftState: 3,
            markerLightsFrontRightState: 3,
            paintType: 5,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 4,
        },
    },
    'cooke280_tender': {
        tender: true,
        name: 'Cooke Consolidation Tender',
        length: 625.0,
        name_length: 11,
        name_lines: 1,
        number_length: 6,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 5,
            smokestackType: 1,
            tenderFuelAmount: 1428,
            tenderWaterAmount: 9500,
        },
    },
    'eureka': {
        engine: true,
        length: 802.13,
        name: 'Eureka',
        name_length: 8,
        name_lines: 1,
        number_length: 2,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            headlightType: 3,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 1,
        },
    },
    'eureka_tender': {
        length: 497.08,
        name: 'Eureka Tender',
        name_length: 18,
        name_lines: 1,
        number_length: 0,
        number_lines: 0,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 1,
            smokestackType: 1,
            tenderFuelAmount: 499,
            tenderWaterAmount: 3800,
        },
    },
    'flatcar_cordwood': {
        freight: true,
        length: 785.6,
        name: 'Flatcar Tier 3',
        name_length: 8,
        name_lines: 1,
        number_length: 8,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 7,
            smokestackType: 1,
        },
    },
    'flatcar_hopper': {
        freight: true,
        length: 785.6,
        name: 'Hopper',
        name_length: 7,
        name_lines: 1,
        number_length: 4,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
    },
    'flatcar_logs': {
        freight: true,
        length: 785.6,
        name: 'Flatcar Tier 1',
        name_length: 7,
        name_lines: 1,
        number_length: 12,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 7,
            smokestackType: 1,
        },
    },
    'flatcar_stakes': {
        freight: true,
        length: 785.6,
        name: 'Flatcar Tier 2',
        name_length: 8,
        name_lines: 1,
        number_length: 8,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 7,
            smokestackType: 1,
        },
    },
    'flatcar_tanker': {
        freight: true,
        length: 785.6,
        name: 'Tanker',
        name_length: 19,
        name_lines: 1,
        number_length: 12,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 10,
            smokestackType: 1,
        },
    },
    'glenbrook': {
        engine: true,
        length: 837.83,
        name: 'Glenbrook',
        name_length: 12,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            headlightType: 3,
            paintType: 6,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 5,
        },
    },
    'glenbrook_tender': {
        length: 505.0,
        name: 'Glenbrook Tender',
        name_length: 11,
        name_lines: 1,
        number_length: 6,
        number_lines: 1,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 6,
            smokestackType: 1,
            tenderFuelAmount: 798,
            tenderWaterAmount: 3800,
        },
    },
    'handcar': {
        handcar: true,
        length: 220.2,
        name: 'Handcar',
        name_length: 18,
        name_lines: 1,
        number_length: 5,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerPressure: 120,
            boilerWaterLevel: 100,
            boilerWaterTemp: 10,
            brakeValue: 1,
            headlightType: 1,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            smokestackType: 1,
            tenderFuelAmount: 20,
        },
    },
    'heisler': {
        engine: true,
        length: 913.73,
        name: 'Heisler',
        name_length: 11,
        name_lines: 6,
        number_length: 2,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 80,
            boilerPressure: 160,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            compressorAirPressure: 100,
            compressorValveValue: 1,
            headlightType: 3,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 3,
            tenderFuelAmount: 454,
            tenderWaterAmount: 3000,
        },
    },
    'montezuma': {
        engine: true,
        length: 680.0,
        name: 'Montezuma',
        name_length: 12,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 2,
            paintType: 2,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 3,
        },
    },
    'montezuma_tender': {
        length: 420.0,
        name: 'Montezuma Tender',
        name_length: 11,
        name_lines: 1,
        number_length: 6,
        number_lines: 1,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 2,
            smokestackType: 1,
            tenderFuelAmount: 470,
            tenderWaterAmount: 5900,
        },
    },
    'mosca': {
        engine: true,
        length: 873.0,
        name: 'Mosca',
        name_length: 12,
        name_lines: 1,
        number_length: 3,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 70,
            boilerPressure: 130,
            boilerWaterLevel: 5000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 3,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 5,
        },
    },
    'mosca_tender': {
        length: 530.0,
        name: 'Mosca Tender',
        name_length: 11,
        name_lines: 1,
        number_length: 6,
        number_lines: 1,
        tender: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
            tenderFuelAmount: 854,
            tenderWaterAmount: 3800,
        },
    },
    'plow': {
        length: 610.0,
        name: 'Snow Plow',
        name_length: 10,
        name_lines: 2,
        number_length: 4,
        number_lines: 1,
        mow: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            brakeValue: 1,
            headlightType: 1,
            markerLightsFrontLeftState: 3,
            markerLightsFrontRightState: 3,
            paintType: 4,
            smokestackType: 1,
        },
    },
    'porter_040': {
        engine: true,
        length: 391.2,
        name: 'Porter',
        name_length: 12,
        name_lines: 1,
        number_length: 2,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 50,
            boilerPressure: 120,
            boilerWaterLevel: 500,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 2,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 1,
            tenderFuelAmount: 66,
            tenderWaterAmount: 800,
        },
    },
    'porter_042': {
        engine: true,
        length: 461.35,
        name: 'Porter 2',
        name_length: 12,
        name_lines: 1,
        number_length: 2,
        number_lines: 1,
        min: {
            paintType: 1,
            reverserValue: -1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 50,
            boilerPressure: 120,
            boilerWaterLevel: 500,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 2,
            paintType: 1,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 1,
            tenderFuelAmount: 164,
            tenderWaterAmount: 800,
        },
    },
    'shay': {
        engine: true,
        length: 800.0,
        name: 'Shay',
        name_length: 12,
        name_lines: 1,
        number_length: 2,
        number_lines: 1,
        min: {
            headlightType: 1,
            paintType: 1,
            reverserValue: -1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 80,
            boilerPressure: 160,
            boilerWaterLevel: 4000,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 3,
            paintType: 3,
            regulatorValue: 1,
            reverserValue: 1,
            sanderAmount: 100,
            smokestackType: 4,
            tenderFuelAmount: 317,
            tenderWaterAmount: 3000,
        },
    },
    'waycar': {
        length: 615.0,
        name: 'DSP&P Waycar',
        name_length: 21,
        name_lines: 1,
        number_length: 12,
        number_lines: 1,
        passenger: true,
        min: {
            headlightType: 1,
            paintType: 1,
            smokestackType: 1,
        },
        max: {
            boilerFireTemp: 400,
            boilerFuelAmount: 50,
            boilerPressure: 120,
            boilerWaterLevel: 500,
            boilerWaterTemp: 110,
            brakeValue: 1,
            headlightType: 1,
            markerLightsFrontLeftState: 3,
            markerLightsFrontRightState: 3,
            markerLightsRearLeftState: 3,
            markerLightsRearRightState: 3,
            paintType: 13,
            smokestackType: 1,
            tenderFuelAmount: 25,
        },
    },
};

interface FrameStateMetadata {
    name: string;
    type?: ('slider' | string[]);
    unit?: string;
    step?: number;
}

export const frameStateMetadata = {
    boilerFireTemp: {
        name: 'Boiler Fire Temperature',
        type: 'slider',
        unit: 'C',
    },
    boilerFuelAmount: {
        name: 'Boiler Fuel',
        type: 'slider',
    },
    boilerPressure: {
        name: 'Boiler Pressure',
        type: 'slider',
        unit: 'psi',
    },
    boilerWaterLevel: {
        name: 'Boiler Water',
        type: 'slider',
        unit: 'L',
    },
    boilerWaterTemp: {
        name: 'Boiler Water Temperature',
        type: 'slider',
        unit: 'C',
    },
    brakeValue: {
        name: 'Brake',
        type: 'slider',
        step: 0.01,
    },
    compressorAirPressure: {
        name: 'Compressor Air Pressure',
        type: 'slider',
        unit: 'psi',
    },
    compressorValveValue: {
        name: 'Compressor',
        type: 'slider',
        step: 0.01,
    },
    generatorValveValue: {
        name: 'Generator',
        type: 'slider',
        step: 0.01,
    },
    headlightType: {
        name: 'Headlight',
    },
    markerLightsCenterState: {
        name: 'Marker Lights Center',
        type: ['None', 'Green', 'Red', 'White'],
    },
    markerLightsFrontLeftState: {
        name: 'Marker Lights Front Left',
        type: ['None', 'Green', 'Red', 'White'],
    },
    markerLightsFrontRightState: {
        name: 'Marker Lights Front Right',
        type: ['None', 'Green', 'Red', 'White'],
    },
    markerLightsRearLeftState: {
        name: 'Marker Lights Rear Left',
        type: ['None', 'Green', 'Red', 'White'],
    },
    markerLightsRearRightState: {
        name: 'Marker Lights Rear Right',
        type: ['None', 'Green', 'Red', 'White'],
    },
    paintType: {
        name: 'Paint',
    },
    regulatorValue: {
        name: 'Regulator',
        type: 'slider',
        step: 0.01,
    },
    reverserValue: {
        name: 'Reverser',
        type: 'slider',
        step: 0.01,
    },
    sanderAmount: {
        name: 'Sand',
        type: 'slider',
    },
    smokestackType: {
        name: 'Smokestack',
    },
    tenderFuelAmount: {
        name: 'Firewood',
        type: 'slider',
        unit: 'logs',
    },
    tenderWaterAmount: {
        name: 'Tank Water',
        type: 'slider',
        unit: 'L',
    },
} satisfies Record<keyof NumericFrameState, Readonly<FrameStateMetadata>>;

export const cargoLimits = {
    boxcar: {
        crate_tools: 32,
    },
    flatcar_cordwood: {
        cordwood: 8,
        oilbarrel: 46,
    },
    flatcar_hopper: {
        coal: 10,
        ironore: 10,
    },
    flatcar_logs: {
        log: 6,
        steelpipe: 9,
    },
    flatcar_stakes: {
        beam: 3,
        lumber: 6,
        rail: 10,
        rawiron: 3,
    },
    flatcar_tanker: {
        crudeoil: 12,
    },
} as const satisfies PRO<FrameType, PRO<CargoType, number>>;

export const hasCargoLimits = (type: GvasString): type is keyof typeof cargoLimits =>
    type ? type in cargoLimits : false;

export const cargoTypes = {
    beam: 'Beams',
    coal: 'Coal',
    cordwood: 'Cordwood',
    crate_tools: 'Tool Crates',
    crudeoil: 'Crude Oil',
    ironore: 'Iron Ore',
    log: 'Logs',
    lumber: 'Lumber',
    oilbarrel: 'Oil Barrels',
    rail: 'Rails',
    rawiron: 'Raw Iron',
    steelpipe: 'Steel Pipes',
} as const satisfies PRO<string, string>;

export const isCargoType = (type: GvasString): type is CargoType =>
    type ? type in cargoTypes : false;

export type CargoType = keyof typeof cargoTypes;
